import{formatTime,timeToMinutes,getDateKey}from"../utils/helpers.js";export function enterFocusMode(){this.state.systemMode="focus";this.elements.focusOverlay.classList.remove("hidden");const now=new Date();const tasks=this.scheduleEngine.getScheduleForDate(now);const currentTask=this.findCurrentTask(tasks,now);if(currentTask){this.elements.focusTask.textContent=currentTask.title;}
this.startFocusTimer();}
export function enterLockdownMode(){this.showMessageModal("Lockdown mode blocks all distractions for 25 minutes. Continue?","LOCKDOWN MODE",()=>{this.state.systemMode="lockdown";this.elements.lockdownOverlay.classList.remove("hidden");const now=new Date();const tasks=this.scheduleEngine.getScheduleForDate(now);const currentTask=this.findCurrentTask(tasks,now);if(currentTask){this.elements.lockdownTask.textContent=currentTask.title;}
this.startLockdownTimer(25);},()=>{});}
export function exitFocusMode(){this.state.systemMode="normal";this.elements.focusOverlay.classList.add("hidden");if(this.timers.focus){clearInterval(this.timers.focus);}}
export function startFocusTimer(){let seconds=0;this.timers.focus=setInterval(()=>{seconds++;const hours=Math.floor(seconds/3600);const minutes=Math.floor((seconds%3600)/60);const secs=seconds%60;this.elements.focusTimer.textContent=`${hours
      .toString()
      .padStart(2, "0")}:${minutes.toString().padStart(2, "0")}:${secs
      .toString()
      .padStart(2, "0")}`;},1000);}
export function startLockdownTimer(minutes){let seconds=minutes*60;this.timers.lockdown=setInterval(()=>{seconds--;if(seconds<=0){clearInterval(this.timers.lockdown);this.exitLockdownMode();this.showNotification("Lockdown complete. Return to normal mode.","success");return;}
const hours=Math.floor(seconds/3600);const mins=Math.floor((seconds%3600)/60);const secs=seconds%60;this.elements.lockdownTimer.textContent=`${hours
      .toString()
      .padStart(2, "0")}:${mins.toString().padStart(2, "0")}:${secs
      .toString()
      .padStart(2, "0")}`;},1000);}
export function exitLockdownMode(){this.state.systemMode="normal";this.elements.lockdownOverlay.classList.add("hidden");if(this.timers.lockdown){clearInterval(this.timers.lockdown);}}
export function enterSleepMode(){this.state.systemMode="sleep";this.elements.sleepOverlay.classList.remove("hidden");this.startSleepTimer();}
export function startSleepTimer(){const now=new Date();const currentHour=now.getHours();const currentMinute=now.getMinutes();let targetHour=5;let secondsUntilTarget;if(currentHour<5||(currentHour===5&&currentMinute===0)){secondsUntilTarget=targetHour*3600-
(currentHour*3600+currentMinute*60+now.getSeconds());}else{secondsUntilTarget=24*3600-
(currentHour*3600+currentMinute*60+now.getSeconds())+
targetHour*3600;}
this.timers.sleep=setInterval(()=>{secondsUntilTarget--;if(secondsUntilTarget<=0){clearInterval(this.timers.sleep);this.exitSleepMode();return;}
const hours=Math.floor(secondsUntilTarget/3600);const minutes=Math.floor((secondsUntilTarget%3600)/60);const seconds=secondsUntilTarget%60;this.elements.sleepTimer.textContent=`${hours
      .toString()
      .padStart(2, "0")}:${minutes.toString().padStart(2, "0")}:${seconds
      .toString()
      .padStart(2, "0")}`;},1000);}
export function exitSleepMode(){this.state.systemMode="normal";this.elements.sleepOverlay.classList.add("hidden");if(this.timers.sleep){clearInterval(this.timers.sleep);}}